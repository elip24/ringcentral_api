from playwright.sync_api import sync_playwright, TimeoutError
import re
start_url='https://www.gibsondunn.com/people/?_people_location=century-city%2Cdallas%2Cdenver%2Chouston%2Clos-angeles%2Cnew-york%2Corange-county%2Csan-francisco%2Cwashington-dc&_people_practices=projects'

def extract_each_profile(playwright):
    browser = playwright.chromium.launch(headless=False)
    custom_headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36",
        "Accept-Language": "en-US,en;q=0.9",
    }
    context = browser.new_context(extra_http_headers=custom_headers)
    page=browser.new_page()
    page.goto(start_url)
    while True:
        try:
            load_more = page.get_by_role("button", name=re.compile("Load more", re.IGNORECASE))
            if load_more.is_visible():
                print("Looking for")
                load_more.click()
                print("Clicking")
                page.wait_for_timeout(2000)
            else:
                print("Timed out waiting for 'Load more'")
                break



        except TimeoutError:
            print("Timed out waiting for 'Load more'")
            break

        except Exception as e:
            print(f"Error: {e}")
            break


with sync_playwright() as playwright:
    extract_each_profile(playwright)
